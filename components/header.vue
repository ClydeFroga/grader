<template>
  <header class="graderHeader">

      <nav class="navbar navbar-expand-lg">
        <div class="container-md">
          <nuxt-link class="navbar-brand" to="/">
            <img
              class="graderHeader__logo"
              src="@/static/whiteLogo.png"
              alt="logo"
            />
          </nuxt-link>

          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
            @click="openDropdown('.expanded')"
          >
                <svg-icon width="30" height="30" class="navbar-toggler-icon" name="list"></svg-icon>
              </button>

          <div class="collapse navbar-collapse expanded" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" @click="openDropdown('.top_drop')">
                  –ñ—É—Ä–Ω–∞–ª ¬´–ì—Ä–µ–π–¥–µ—Ä¬ª
                </a>
                <div class="dropdown-menu top_drop hide" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://igrader.promogroupmedia.ru/">–û –∂—É—Ä–Ω–∞–ª–µ</a>
                  <nuxt-link class="dropdown-item" to="/archive">–ê—Ä—Ö–∏–≤</nuxt-link>
                  <nuxt-link class="dropdown-item" :to="{name: 'pages-slug', params: {slug: 'about'}}">–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∂—É—Ä–Ω–∞–ª</nuxt-link>
                </div>
              </li>
              <li class="nav-item">
                <nuxt-link class="nav-link" to="/events">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</nuxt-link>
              </li>
              <li class="nav-item">
                <nuxt-link class="nav-link" to="/comtrans-2019">Comtrans 2019</nuxt-link>
              </li>
              <li class="nav-item">
                <nuxt-link class="nav-link" :to="{name: 'news-slug', params: {slug: 'specialoffer'}}">üî• –°–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</nuxt-link>
              </li>
              <li class="nav-item">
                <nuxt-link class="nav-link" :to="{name: 'pages-slug', params: {slug: 'adv'}}">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è–º</nuxt-link>
              </li>
            </ul>
          </div>

          <span  @click="openModal()" class="searchIcon">
            <i>
              <svg-icon name="search" width="15" height="15"></svg-icon>
            </i>
          </span>
          </div>
      </nav>

    <nav class="graderHeader__bot navbar navbar-expand-lg">
      <div class=" collapse navbar-collapse expanded"  id="navbarSupportedContent">
        <div class="container-md collapsed-cont">

        <ul class="nav nav-tabs">
          <li class="nav-item">
            <nuxt-link class="nav-link active" :to="{ name: 'lane'}">–ü–æ–ª–æ—Å–∞</nuxt-link>
          </li>
          <li class="nav-item">
            <nuxt-link class="nav-link" :to="{ name: 'kratko'}">–ù–æ–≤–æ—Å—Ç–∏</nuxt-link>
          </li>
          <li class="nav-item">
            <nuxt-link class="nav-link" :to="{ name: 'news-slug', params: { slug: 'ryinok' } }">–û–±–∑–æ—Ä —Ä—ã–Ω–∫–∞</nuxt-link>
          </li>
          <li class="nav-item">
            <nuxt-link class="nav-link" :to="{ name: 'news-slug', params: { slug: 'ispyitateli' } }">–ò—Å–ø—ã—Ç–∞—Ç–µ–ª–∏</nuxt-link>
          </li>
          <li class="nav-item">
            <nuxt-link class="nav-link" :to="{ name: 'news-slug', params: { slug: 'krupniym-planom' } }">–ö—Ä—É–ø–Ω—ã–º –ø–ª–∞–Ω–æ–º</nuxt-link>
          </li>
          <li class="nav-item">
            <nuxt-link class="nav-link" :to="{ name: 'news-slug', params: { slug: 'servismenyi' } }">–°–µ—Ä–≤–∏—Å–º–µ–Ω—ã</nuxt-link>
          </li>
          <li class="nav-item">
            <nuxt-link class="nav-link" :to="{ name: 'news-slug', params: { slug: 'stranitci-istorii' } }">–°—Ç—Ä–∞–Ω–∏—Ü—ã –∏—Å—Ç–æ—Ä–∏–∏</nuxt-link>
          </li>

          <li @click="openDropdown('.bot_dropdown')" class="nav-item dropdown bot_dropbtn">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">–ï—â—ë —Ä—É–±—Ä–∏–∫–∏</a>
            <div class="dropdown-menu bot_dropdown hide">
              <nuxt-link class="dropdown-item" :to="{ name: 'news-slug', params: { slug: 'analitika' } }">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</nuxt-link>
              <nuxt-link class="dropdown-item" :to="{ name: 'news-slug', params: { slug: 'kruglyj-stol' } }">–ö—Ä—É–≥–ª—ã–π —Å—Ç–æ–ª</nuxt-link>
              <nuxt-link class="dropdown-item" :to="{ name: 'news-slug', params: { slug: 'technology' } }">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</nuxt-link>
            </div>
          </li>
        </ul>

        </div>
      </div>
    </nav>

    <div class="searchBlock" id="search">
      <div class="input-group">
        <input @keyup.enter.prevent="allRequests(searchQuery)" v-model="searchQuery" type="search" class="form-control" placeholder="–ß—Ç–æ –∏—â–µ–º?" aria-describedby="button-addon2">
        <div class="input-group-append">
          <button @click="allRequests(searchQuery)" class="btn" type="submit" id="button-addon2">–ü–æ–∏—Å–∫</button>
        </div>
      </div>
    </div>
  </header>
</template>

<script>
export default {
  data() {
    return {
      searchQuery: '',
    }
  },
  methods: {
    allRequests(request) {
      let modal = document.querySelector('.searchBlock')
      modal.style.display = ''
      this.$router.push('/search/' + request)
      this.searchQuery = ''
    },
    openModal() {
      let modal = document.querySelector('.searchBlock')
      modal.style.display = 'block'
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }
    },
    openDropdown(dropdownw) {
      let exp = document.querySelectorAll(dropdownw)

      if(dropdownw == '.expanded') {
        for (let el of exp) {
          el.classList.toggle('collapse')
        }
      } else {
        let dropdown = document.querySelector(dropdownw)
        let item = document.querySelectorAll('.dropdown-item')

        dropdown.classList.toggle('hide')

        document.addEventListener('mouseup', function (e) {
          const its_menu = e.target == dropdown || dropdown.contains(e.target);
          const its_item = true
          console.log(item)

          if (its_item || !its_menu && !dropdown.classList.contains('hide')) {
            dropdown.classList.add('hide');
            document.removeEventListener('mouseup', () => {

            })
          }
        })
      }
    },
  }
};
</script>
